<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>ci/cd on HimawariSunFlower&#39;s home</title>
    <link>http://HimawariSunFlower.github.io/categories/ci/cd/</link>
    <description>Recent content in ci/cd on HimawariSunFlower&#39;s home</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language><atom:link href="http://HimawariSunFlower.github.io/categories/ci/cd/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>gitlab ci/cd&#43;ansible è¿œç¨‹sshæœåŠ¡å™¨deployé‡åˆ°çš„é—®é¢˜</title>
      <link>http://HimawariSunFlower.github.io/posts/cicd_2/</link>
      <pubDate>Tue, 18 Oct 2022 16:05:27 +0800</pubDate>
      
      <guid>http://HimawariSunFlower.github.io/posts/cicd_2/</guid>
      <description> è°ƒç”¨æœ¬åœ°shæ–‡ä»¶éœ€è¦æƒé™ æŠ¥é”™ï¼š/bin/bash: deploy.sh: Permission denied è§£å†³ï¼šåœ¨ymlè°ƒç”¨shå‰chmod777 deploy.sh gitlabå˜é‡é»˜è®¤åªåœ¨å—ä¿æŠ¤çš„åˆ†æ”¯ä¸Šç”Ÿæ•ˆ æŠ¥é”™ï¼šç›´æ¥ä½¿ç”¨å˜é‡ä¼šæ‰¾ä¸åˆ° è§£å†³ï¼šå°†å¯¹åº”åˆ†æ”¯è®¾ç½®ä¸ºå—ä¿æŠ¤ ansibleè¿æ¥è¿œç¨‹æœåŠ¡å™¨å¤±è´¥ æŠ¥é”™ï¼š Unable to parse /Users/mac/root@host1 as an inventory source è§£å†³ï¼šæ³¨æ„ï¼šå¦‚æœä¼ å…¥çš„èŠ‚ç‚¹åªæœ‰ä¸€å°ï¼Œæœ«å°¾çš„é€—å·ä¸èƒ½çœç•¥ğŸ”— ansible all -i host161,host162 &amp;ndash;list-hosts ansible all -i host161, &amp;ndash;list-hosts sshå¯†é’¥è®¤è¯å¤±è´¥ æŠ¥é”™ï¼š root@hosts | UNREACHABLE! =&amp;gt; { &amp;#34;changed&amp;#34;: false, &amp;#34;msg&amp;#34;: &amp;#34;Failed to connect to the host via ssh: Host key verification failed.&amp;#34;, &amp;#34;unreachable&amp;#34;: true } è§£å†³ï¼šéœ€è¦å‚æ•° &amp;ndash;ssh-common-args=&amp;rsquo;-o StrictHostKeyChecking=no&#39; æ€»ä½“belikeï¼šansible &amp;ndash;ssh-common-args=&amp;rsquo;-o StrictHostKeyChecking=no&amp;rsquo; -i &amp;ldquo;$DEPLOY_TO_HOSTS&amp;rdquo;, &amp;ldquo;*&amp;rdquo; -m command -a &amp;rsquo;ls&#39; ansible å‚è€ƒ æ–°å»ºæ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶ ç”¨fileæ¨¡å— æ‹·è´æœ¬æœºæ–‡ä»¶å»è¿œç¨‹æœåŠ¡å™¨ ç”¨copyæ¨¡å— commandæ¨¡å— ä¸èƒ½ä½¿ç”¨&amp;gt;,&amp;lt;,cdç­‰æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨shellæ¨¡å— &amp;ldquo;nohup &amp;amp;&amp;rdquo; linuxåå°è¿è¡Œç¨‹åº </description>
    </item>
    
    <item>
      <title>gitlab ci/cd</title>
      <link>http://HimawariSunFlower.github.io/posts/cicd_1/</link>
      <pubDate>Tue, 11 Oct 2022 16:05:27 +0800</pubDate>
      
      <guid>http://HimawariSunFlower.github.io/posts/cicd_1/</guid>
      <description>å®˜æ–¹æ–‡æ¡£
å…³äºå¤§ä»“æ¨¡å¼å¾®æœåŠ¡çš„ci/cdæ„å»º
cdåº”è¯¥é’ˆå¯¹masteråˆ†æ”¯ï¼Œä¹Ÿå°±æ˜¯ä¸»åˆ†æ”¯ä»£ç æäº¤æ—¶(å‘ç‰ˆæ—¶)æ‰è§¦å‘è‡ªåŠ¨æ„å»ºã€‚ æˆ‘ä»¬é€šå¸¸åªæƒ³æ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²åº”ç”¨ç¨‹åºçš„é‚£äº›å·²ç»æ›´æ”¹çš„æœåŠ¡ãƒ¼ãƒ¼è€Œä¸æ˜¯å°†æ‰€æœ‰æœåŠ¡æ”¾åœ¨ä¸€èµ·ï¼Œå› ä¸ºè¿™å¯èƒ½éå¸¸è€—æ—¶ã€‚ä½¿ç”¨only/changeå­å¥æ¥å®ç°ã€‚rule/changesåº”å½“æ˜¯æ›´å¥½çš„å®ç°ã€‚ æ ¹æ®gitlabå®˜æ–¹çš„cicdå®ç°ï¼Œæ ¹ç›®å½•çš„ymlå»include ciæ–‡ä»¶å¤¹ä¸‹çš„å¯¹åº”æœåŠ¡çš„ymlæ–‡ä»¶ï¼Œæ¥å®ç°ä¸€ä¸ªå¤§ä»“ä¸‹å¤šä¸ªæœåŠ¡çš„cicdã€‚ todo å¦‚ä½•å»å‘å¸ƒåˆ°ä¸åŒæœåŠ¡å™¨ï¼Ÿ ç›®å‰é€‰ç”¨ansible todo k8s è¸©å‘ï¼š
jobs config should contain at least one visible job https://gitlab.com/gitlab-org/gitlab/-/issues/341693 ç–‘ä¼¼å·²ä¿®å¤ï¼Œgitlab15.2 è¯·æ³¨æ„ï¼ŒGitLab Runner çš„é»˜è®¤ pull policy ä¸º alwaysï¼Œè¿™æ„å‘³ç€å³ä½¿æœ¬åœ°å‰¯æœ¬å¯ç”¨ï¼Œrunner ä¹Ÿä¼šå°è¯•ä» GitLab å®¹å™¨é•œåƒåº“ä¸­æå– Docker é•œåƒã€‚å¦‚æœæ‚¨æ›´å–œæ¬¢ä»…ä½¿ç”¨æœ¬åœ°å¯ç”¨çš„ Docker é•œåƒï¼Œåˆ™å¯ä»¥åœ¨ç¦»çº¿ç¯å¢ƒä¸­å°† GitLab Runner pull_policy è®¾ç½®ä¸º if-not-presentã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸åœ¨ç¦»çº¿ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å»ºè®®å°†æ‹‰å–ç­–ç•¥è®¾ç½®ä¿æŒä¸º alwaysï¼Œå› ä¸ºè¿™æ ·å¯ä»¥åœ¨ CI/CD æµæ°´çº¿ä¸­ä½¿ç”¨æ›´æ–°çš„æ‰«æç¨‹åºã€‚ runneré»˜è®¤ä½¿ç”¨alwaysç­–ç•¥ï¼Œæ— æ³•é€šè¿‡é…ç½®æ–‡ä»¶ä¿®æ”¹ protoc-gen-go: error:inconsistent package import paths protoc-gen-goä¸å­˜åœ¨æŠ¥çš„è¿™ä¸ªé”™è¯¯ï¼Œç¥ç§˜ æ¯ä¸€ä¸ªæ„å»ºéƒ½æ˜¯éš”ç¦»çš„ï¼Œbuild protosè¿™ç§æŒ‡ä»¤åº”å½“æ”¾åˆ°before_scripté‡Œè®©æ¯ä¸ªstageéƒ½è§¦å‘ç”Ÿæˆ only:-changes: è·¯å¾„ä¸èƒ½åŒ…å«å˜é‡ï¼Œç›´æ¥ä»æ ¹ç›®å½•æŒ‡å‘å¯¹åº”ç›®å½• æŠ€å·§
include templateå¯ä»¥ç›´æ¥å¼•ç”¨gitlabå®˜æ–¹é¢„åˆ¶çš„ä¸€äº›æ¨¡æ¿ï¼ŒåŒ…æ‹¬ä»£ç æ£€æŸ¥ä¹‹ç±»çš„ã€‚é“¾æ¥ gitlabæä¾›äº†ä¸€æ‰¹é¢„å®šä¹‰å˜é‡. é“¾æ¥ å‘½ä»¤
dependencies: é€šè¿‡æä¾›è¦ä»ä¸­è·å–äº§ç‰©çš„ä½œä¸šåˆ—è¡¨ï¼Œæ¥é™åˆ¶å°†å“ªäº›äº§ç‰©ä¼ é€’ç»™ç‰¹å®šä½œä¸šã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨ deployé˜¶æ®µdependenciesæŒ‡å®šbuildé˜¶æ®µçš„jobå¯ä»¥å–åˆ°buildæ‰“å‡ºæ¥çš„åŒ…ã€‚ tags:ç”¨äºé€‰æ‹© runner çš„æ ‡ç­¾åˆ—è¡¨ï¼ˆé€‰å–è¿è¡Œå¯¹è±¡ï¼‰ needsï¼šåœ¨ stage é¡ºåºä¹‹å‰æ‰§è¡Œçš„ä½œä¸šï¼ˆå‘åŠ¨æ•ˆæœçš„costï¼‰ extendsï¼šæ­¤ä½œä¸šç»§æ‰¿è‡ªçš„é…ç½®æ¡ç›®ï¼ˆæœ‰ç»§æ‰¿å°±å¯ä»¥æŠ½è±¡ä¸€äº›å…¬ç”¨çš„æ–¹æ³•å‡ºæ¥äº†ï¼‰ artifactsï¼šä½¿ç”¨ artifacts æŒ‡å®šåœ¨ä½œä¸š succeeds, fails, æˆ– always æ—¶é™„åŠ åˆ°ä½œä¸šçš„æ–‡ä»¶å’Œç›®å½•åˆ—è¡¨ã€‚(æ ¹æ®artfactsåœ¨buildï¼Œdeployä¸¤ä¸ªé˜¶æ®µä¼ é€’æ‰“å‡ºæ¥çš„åŒ…) å‚è€ƒæ–‡æ¡£</description>
    </item>
    
  </channel>
</rss>
